<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario de Festivos por Comunidad</title>
    <style>
        /* ... (mantener los estilos existentes) ... */
    </style>
</head>
<body>
    <div class="container">
        <h2>Calendario de Festivos por Comunidad</h2>
        <div class="form-group">
            <label for="anio">Seleccionar Año:</label>
            <select id="anio">
                <option value="2024">2024</option>
                <option value="2025">2025</option>
            </select>
        </div>
        <div class="form-group">
            <label for="comunidad">Seleccionar Comunidad Autónoma:</label>
            <select id="comunidad">
                <option value="">Seleccione una comunidad</option>
                <option value="ES-AN">Andalucía</option>
                <option value="ES-AR">Aragón</option>
                <option value="ES-AS">Asturias</option>
                <option value="ES-IB">Baleares</option>
                <option value="ES-CN">Canarias</option>
                <option value="ES-CB">Cantabria</option>
                <option value="ES-CM">Castilla-La Mancha</option>
                <option value="ES-CL">Castilla y León</option>
                <option value="ES-CT">Cataluña</option>
                <option value="ES-VC">Comunidad Valenciana</option>
                <option value="ES-EX">Extremadura</option>
                <option value="ES-GA">Galicia</option>
                <option value="ES-RI">La Rioja</option>
                <option value="ES-MD">Madrid</option>
                <option value="ES-MC">Murcia</option>
                <option value="ES-NC">Navarra</option>
                <option value="ES-PV">País Vasco</option>
            </select>
        </div>
        <button onclick="obtenerFestivos()">Mostrar Festivos</button>
        <div id="calendario" class="calendar"></div>
        <nav>
            <a href="index.html">Volver al Inicio</a>
        </nav>
    </div>

    <script>
        const API_KEY = '713476495d8a48f794bb5b5d6ec09144'; // Reemplaza con tu API key de Abstract o Calendarific

        async function obtenerFestivos() {
            const anio = document.getElementById('anio').value;
            const comunidad = document.getElementById('comunidad').value;
            const calendarioDiv = document.getElementById('calendario');
            calendarioDiv.innerHTML = 'Cargando...';

            try {
                const url = `https://holidays.abstractapi.com/v1/?api_key=${API_KEY}&country=ES&year=${anio}&region=${comunidad}`;
                const response = await fetch(url);
                const festivos = await response.json();

                mostrarCalendario(festivos, anio);
            } catch (error) {
                console.error('Error al obtener los festivos:', error);
                calendarioDiv.innerHTML = 'Error al cargar los festivos. Por favor, intente de nuevo.';
            }
        }

        function mostrarCalendario(festivos, anio) {
            const calendarioDiv = document.getElementById('calendario');
            calendarioDiv.innerHTML = '';

            const meses = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];

            meses.forEach((mes, index) => {
                const mesDiv = document.createElement('div');
                mesDiv.innerHTML = `<h3>${mes} ${anio}</h3>`;
                const diasMes = new Date(anio, index + 1, 0).getDate();

                for (let dia = 1; dia <= diasMes; dia++) {
                    const fecha = `${anio}-${(index + 1).toString().padStart(2, '0')}-${dia.toString().padStart(2, '0')}`;
                    const festivo = festivos.find(f => f.date === fecha);

                    const diaDiv = document.createElement('div');
                    diaDiv.className = festivo ? 'day festivo' : 'day';
                    diaDiv.innerHTML = `
                        <div>${dia}</div>
                        ${festivo ? `<div class="motivo">${festivo.name}</div>` : ''}
                    `;
                    mesDiv.appendChild(diaDiv);
                }

                calendarioDiv.appendChild(mesDiv);
            });
        }
    </script>
</body>
</html>
